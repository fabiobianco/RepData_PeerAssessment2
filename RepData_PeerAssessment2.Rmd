---
title: "RepData_PeerAssessment2"
author: "by Fabio Bianchini"
date: "18/04/2017"
output:
  html_document:
    keep_md: yes
  pdf_document:
    latex_engine: xelatex
---

```{r Library, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(downloader)  # need for download function
library(R.utils)  # needed for bunzip2 function
library(dplyr)
library(tidyverse)
library(stringr) # need for string manipulation
```

Loading and Processing the Raw Data
```{r, cache=TRUE}
url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"
download(url, "Storm_Data.bz2", mode = "wb") #Download dataset from specific URL
```

```{r,  cache=TRUE}
bunzip2("Storm_Data.bz2", "Storm_data.csv", remove = FALSE, skip = TRUE) # unzip data file
Storm_Data <- read.csv("Storm_data.csv") #
```

```{r}
names(Storm_Data)
head(Storm_Data)
#tail(Storm_Data)
str(Storm_Data)
```

Process/transform the data (if necessary) into a format suitable for your analysis

```{r, Rename Dataset columb}
ds1 <- Storm_Data
names(ds1) <- str_to_lower(names(ds1)) # Rename dataset columb names
names(ds1) <-str_replace(names(ds1), "_+$","") # Remove final underscore from columb names
names(ds1) <- str_replace(names(ds1), "_",".") #
names(ds1)
```

1. Across the United States, which types of events (as indicated in the ð™´ðš…ðšƒðšˆð™¿ð™´ variable) are most harmful with respect to population health?

Check how many difference type events are present in the dataset
```{r}
dim(table(ds1$evtype))
```
it's seems to be `r dim(table(ds1$evtype))` different events but if a check inside I see that the same event name appear in upper and lower case

```{r}
table(ds1$evtype)[21:22]
```
```{r}
ds1$evtype <- str_to_upper(ds1$evtype)
dim(table(ds1$evtype))
table(ds1$evtype)[15:28]

```

The events number decrease from 


## Including Plots

You can also embed plots, for example:


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
